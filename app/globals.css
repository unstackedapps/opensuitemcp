@import "tailwindcss";
@import "katex/dist/katex.min.css";

/* include utility classes in streamdown */
@source '../node_modules/streamdown/dist/index.js';

/* custom variant for setting dark mode programmatically */
@custom-variant dark (&:is(.dark, .dark *));

/* include plugins */
@plugin "tailwindcss-animate";
@plugin "@tailwindcss/typography";

/* define design tokens (light mode) - Gemini-inspired balanced inverse */
:root {
  --background: hsl(0 0% 100%);
  --foreground: hsl(0 0% 10%);
  --card: hsl(0 0% 94%);
  --card-foreground: hsl(0 0% 10%);
  --popover: hsl(0 0% 100%);
  --popover-foreground: hsl(0 0% 10%);
  --primary: hsl(0 0% 10%);
  --primary-foreground: hsl(0 0% 98%);
  --secondary: hsl(0 0% 94%);
  --secondary-foreground: hsl(0 0% 10%);
  --muted: hsl(0 0% 94%);
  --muted-foreground: hsl(0 0% 40%);
  --accent: hsl(0 0% 94%);
  --accent-foreground: hsl(0 0% 10%);
  --destructive: hsl(0 84.2% 60.2%);
  --destructive-foreground: hsl(0 0% 98%);
  --border: hsl(0 0% 85%);
  --input: hsl(0 0% 91%);
  --ring: hsl(0 0% 10%);
  --chart-1: hsl(12 76% 61%);
  --chart-2: hsl(173 58% 39%);
  --chart-3: hsl(197 37% 24%);
  --chart-4: hsl(43 74% 66%);
  --chart-5: hsl(27 87% 67%);
  --sidebar-background: hsl(0 0% 96%);
  --sidebar-foreground: hsl(0 0% 23%);
  --sidebar-primary: hsl(0 0% 10%);
  --sidebar-primary-foreground: hsl(0 0% 98%);
  --sidebar-accent: hsl(0 0% 94%);
  --sidebar-accent-foreground: hsl(0 0% 10%);
  --sidebar-border: hsl(0 0% 88%);
  --sidebar-ring: hsl(217.2 91.2% 59.8%);
  /* border radius unit */
  --radius: 0.5rem;
  --sidebar: hsl(0 0% 96%);
}

/* define design tokens (dark mode) - Gemini-inspired colors */
.dark {
  --background: hsl(210 3% 11%);
  --foreground: hsl(0 0% 98%);
  --card: hsl(240 2% 15%);
  --card-foreground: hsl(0 0% 98%);
  --popover: hsl(210 3% 11%);
  --popover-foreground: hsl(120 2% 78%);
  --primary: hsl(120 2% 78%);
  --primary-foreground: hsl(210 3% 11%);
  --secondary: hsl(240 2% 15%);
  --secondary-foreground: hsl(120 2% 78%);
  --muted: hsl(240 2% 15%);
  --muted-foreground: hsl(120 2% 65%);
  --accent: hsl(240 2% 15%);
  --accent-foreground: hsl(120 2% 78%);
  --destructive: hsl(0 62.8% 30.6%);
  --destructive-foreground: hsl(120 2% 78%);
  --border: hsl(240 2% 20%);
  --input: hsl(210 3% 20%);
  --ring: hsl(120 2% 78%);
  --chart-1: hsl(220 70% 50%);
  --chart-2: hsl(160 60% 45%);
  --chart-3: hsl(30 80% 55%);
  --chart-4: hsl(280 65% 60%);
  --chart-5: hsl(340 75% 55%);
  --sidebar-background: hsl(210 4% 16%);
  --sidebar-foreground: hsl(120 2% 78%);
  --sidebar-primary: hsl(224.3 76.3% 48%);
  --sidebar-primary-foreground: hsl(0 0% 100%);
  --sidebar-accent: hsl(210 4% 22%);
  --sidebar-accent-foreground: hsl(120 2% 78%);
  --sidebar-border: hsl(240 2% 20%);
  --sidebar-ring: hsl(217.2 91.2% 59.8%);
  --sidebar: hsl(210 4% 16%);
}

/* define theme */
@theme {
  --font-sans: var(--font-geist);
  --font-mono: var(--font-geist-mono);

  --breakpoint-toast-mobile: 600px;

  --radius-lg: var(--radius);
  --radius-md: calc(var(--radius) - 2px);
  --radius-sm: calc(var(--radius) - 4px);

  --color-background: var(--background);
  --color-foreground: var(--foreground);

  --color-card: var(--card);
  --color-card-foreground: var(--card-foreground);

  --color-popover: var(--popover);
  --color-popover-foreground: var(--popover-foreground);

  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);

  --color-secondary: var(--secondary);
  --color-secondary-foreground: var(--secondary-foreground);

  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);

  --color-accent: var(--accent);
  --color-accent-foreground: var(--accent-foreground);

  --color-destructive: var(--destructive);
  --color-destructive-foreground: var(--destructive-foreground);

  --color-border: var(--border);
  --color-input: var(--input);
  --color-ring: var(--ring);

  --color-chart-1: var(--chart-1);
  --color-chart-2: var(--chart-2);
  --color-chart-3: var(--chart-3);
  --color-chart-4: var(--chart-4);
  --color-chart-5: var(--chart-5);

  --color-sidebar: var(--sidebar-background);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-sidebar-primary: var(--sidebar-primary);
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-ring: var(--sidebar-ring);
}

/*
  The default border color has changed to `currentcolor` in Tailwind CSS v4,
  so we've added these compatibility styles to make sure everything still
  looks the same as it did with Tailwind CSS v3.

  If we ever want to remove these styles, we need to add an explicit border
  color utility to any element that depends on these defaults.
*/
@layer base {
  *,
  ::after,
  ::before,
  ::backdrop,
  ::file-selector-button {
    border-color: var(--color-gray-200, currentcolor);
  }
}

@utility text-balance {
  text-wrap: balance;
}

@utility -webkit-overflow-scrolling-touch {
  -webkit-overflow-scrolling: touch;
}

@utility touch-pan-y {
  touch-action: pan-y;
}

@utility overscroll-behavior-contain {
  overscroll-behavior: contain;
}

@layer utilities {
  :root {
    --foreground-rgb: 0, 0, 0;
    --background-start-rgb: 214, 219, 220;
    --background-end-rgb: 255, 255, 255;
  }

  @media (prefers-color-scheme: dark) {
    :root {
      --foreground-rgb: 255, 255, 255;
      --background-start-rgb: 0, 0, 0;
      --background-end-rgb: 0, 0, 0;
    }
  }
}

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply bg-background text-foreground;
    overflow-x: hidden;
    position: relative;
  }

  html {
    overflow-x: hidden;
  }
}

.skeleton {
  * {
    pointer-events: none !important;
  }

  *[class^="text-"] {
    color: transparent;
    @apply rounded-md bg-foreground/20 select-none animate-pulse;
  }

  .skeleton-bg {
    @apply bg-foreground/10;
  }

  .skeleton-div {
    @apply bg-foreground/20 animate-pulse;
  }
}

.ProseMirror {
  outline: none;
}

.cm-editor,
.cm-gutters {
  @apply bg-background! dark:bg-zinc-800! outline-hidden! selection:bg-zinc-900!;
}

.ͼo.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground,
.ͼo.cm-selectionBackground,
.ͼo.cm-content::selection {
  @apply bg-zinc-200! dark:bg-zinc-900!;
}

.cm-activeLine,
.cm-activeLineGutter {
  @apply bg-transparent!;
}

.cm-activeLine {
  @apply rounded-r-sm!;
}

.cm-lineNumbers {
  @apply min-w-7;
}

.cm-foldGutter {
  @apply min-w-3;
}

.cm-lineNumbers .cm-activeLineGutter {
  @apply rounded-l-sm!;
}

/* minimal scrollbar styling */
::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}

::-webkit-scrollbar-track {
  background: transparent;
}

::-webkit-scrollbar-thumb {
  background: var(--border);
  border-radius: 3px;
  transition: background 0.2s ease;
}

::-webkit-scrollbar-thumb:hover {
  background: --alpha(var(--muted-foreground) / 0.5);
}

/* Hide scrollbar in sidebar */
[data-sidebar="content"],
[data-sidebar="sidebar"] {
  scrollbar-width: none !important;
  -ms-overflow-style: none !important;
}

[data-sidebar="content"]::-webkit-scrollbar,
[data-sidebar="sidebar"]::-webkit-scrollbar {
  display: none !important;
  width: 0 !important;
  height: 0 !important;
}

::-webkit-scrollbar-corner {
  background: transparent;
}

/* firefox scrollbar styling */
* {
  scrollbar-width: thin;
  scrollbar-color: var(--border) transparent;
}

/* hide scrollbar utility */
.scrollbar-hide {
  -ms-overflow-style: none; /* IE and Edge */
  scrollbar-width: none; /* Firefox */
}

/* smooth bounce animation for loading dots */
@keyframes smooth-bounce {
  0%,
  100% {
    transform: translateY(0);
    animation-timing-function: cubic-bezier(0.8, 0, 1, 1);
  }
  50% {
    transform: translateY(-0.75rem);
    animation-timing-function: cubic-bezier(0, 0, 0.2, 1);
  }
}

@theme {
  --animate-smooth-bounce: smooth-bounce 1.4s infinite;
}

.animate-smooth-bounce {
  animation: smooth-bounce 1.4s infinite;
}

.scrollbar-hide::-webkit-scrollbar {
  display: none; /* Chrome, Safari and Opera */
}

@theme inline {
  --color-sidebar: var(--sidebar);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-sidebar-primary: var(--sidebar-primary);
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-ring: var(--sidebar-ring);
}

@layer base {
  * {
    @apply border-border outline-ring/50;
  }
  body {
    @apply bg-background text-foreground;
  }
}

@keyframes spin-gradient {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

.animate-spin-gradient {
  animation: spin-gradient 2s linear infinite;
}

/* React Flow Controls and Minimap Styling */
.react-flow__controls {
  background: hsl(var(--card)) !important;
  border: 1px solid hsl(var(--border)) !important;
  border-radius: 0.5rem !important;
  box-shadow:
    0 1px 3px 0 rgb(0 0 0 / 0.1),
    0 1px 2px -1px rgb(0 0 0 / 0.1) !important;
}

.react-flow__controls-button {
  background: hsl(var(--card)) !important;
  border-bottom: 1px solid hsl(var(--border)) !important;
  color: hsl(var(--foreground)) !important;
  fill: hsl(var(--foreground)) !important;
}

.react-flow__controls-button:hover {
  background: hsl(var(--accent)) !important;
}

.react-flow__controls-button:last-child {
  border-bottom: none !important;
}

.react-flow__minimap {
  background: hsl(var(--card)) !important;
  border: 1px solid hsl(var(--border)) !important;
  border-radius: 0.5rem !important;
  box-shadow:
    0 1px 3px 0 rgb(0 0 0 / 0.1),
    0 1px 2px -1px rgb(0 0 0 / 0.1) !important;
}

.react-flow__minimap-mask {
  fill: hsl(var(--background) / 0.3) !important;
}

.react-flow__minimap-node {
  fill: hsl(var(--muted)) !important;
  stroke: hsl(var(--border)) !important;
}

.react-flow__minimap-node.selected {
  fill: hsl(var(--primary)) !important;
  stroke: hsl(var(--primary)) !important;
}

/* Hide React Flow attribution */
.react-flow__attribution {
  display: none !important;
}

/* Animated flow direction for edges */
@keyframes flow-dash {
  0% {
    stroke-dashoffset: 0;
  }
  100% {
    stroke-dashoffset: -20;
  }
}

.react-flow__edge-path {
  stroke: hsl(var(--border));
  stroke-width: 2;
  stroke-dasharray: 5 5;
  animation: flow-dash 1s linear infinite;
}

.react-flow__edge.selected .react-flow__edge-path {
  stroke: hsl(var(--primary));
  stroke-width: 3;
  stroke-dasharray: 8 4;
}
